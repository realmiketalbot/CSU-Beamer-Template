\ProvidesPackage{CSU}

\mode<presentation>

\newif\ifbeamer@secheader
\beamer@secheaderfalse
\ProcessOptionsBeamer

% Load base themes
\useoutertheme[footline=authorinstitutetitle,subsection=false]{smoothbars}
\useinnertheme{circles}

% CSU Brand Colors
\definecolor{csuGreen}{HTML}{1E4D2B}       % Primary CSU Green
\definecolor{aggieOrange}{HTML}{F26322}    % Aggie Orange (Accent)
\definecolor{csuGold}{HTML}{C8C372}        % CSU Gold (Secondary)
\definecolor{eightyBlack}{gray}{0.2}       % For dark gray text or lines

\setbeamercolor{footline}{bg=csuGreen}
\setbeamercolor{frametitle}{bg=csuGreen,fg=white}
\setbeamercolor{title}{bg=csuGreen,fg=white}
\setbeamerfont{frametitle}{size=\large}

\setbeamertemplate{bibliography item}[text]
\setbeamertemplate{caption}[numbered]

\setbeamercolor{palette primary}{use=structure,fg=white,bg=structure.fg}
\setbeamercolor{palette secondary}{use=structure,fg=white,bg=structure.fg!75!black}
\setbeamercolor{palette tertiary}{use=structure,fg=white,bg=structure.fg!50!black}
\setbeamercolor{palette quaternary}{fg=white,bg=structure.fg!50!black}
\setbeamercolor{titlelike}{parent=palette primary}

\setbeamercolor{block title}{bg=csuGreen,fg=white}
\setbeamercolor*{block title example}{use={normal text,example text},bg=white,fg=csuGreen}
\setbeamercolor{block title alerted}{bg=aggieOrange,fg=white}
\setbeamercolor{item projected}{fg=white,bg=csuGold}

\setbeamercolor{fine separation line}{}
\setbeamercolor{palette sidebar primary}{use=normal text,fg=normal text.fg}
\setbeamercolor{palette sidebar quaternary}{use=structure,fg=structure.fg}
\setbeamercolor{palette sidebar secondary}{use=structure,fg=structure.fg}
\setbeamercolor{palette sidebar tertiary}{use=normal text,fg=normal text.fg}

\setbeamercolor{section in sidebar}{fg=aggieOrange}
\setbeamercolor{section in sidebar shaded}{fg=gray}
\setbeamercolor{subsection in sidebar}{fg=csuGold}
\setbeamercolor{subsection in sidebar shaded}{fg=gray}

\setbeamercolor{structure}{fg=csuGreen}
\setbeamercolor{sidebar}{bg=csuGreen}

\setbeamercolor{alerted text}{fg=aggieOrange}

% Frame number / page count footer
\makeatletter
\newcommand{\frameofframes}{/}
\newcommand{\setframeofframes}[1]{\renewcommand{\frameofframes}{#1}}
\setbeamertemplate{footline} 
  {%%
    \begin{beamercolorbox}[colsep=1.5pt]{upper separation line foot}
    \end{beamercolorbox}
    \begin{beamercolorbox}[ht=2.5ex,dp=1.125ex,leftskip=.3cm,rightskip=.3cm plus1fil]{author in head/foot}%
      \leavevmode{\usebeamerfont{author in head/foot}\insertshortauthor}%
      \hfill%
      {\usebeamerfont{institute in head/foot}\usebeamercolor[fg]{institute in head/foot}\insertshortinstitute}%
    \end{beamercolorbox}%
    \begin{beamercolorbox}[ht=2.5ex,dp=1.125ex,leftskip=.3cm,rightskip=.3cm plus1fil]{title in head/foot}%
      {\usebeamerfont{title in head/foot}\insertshorttitle}%
      \hfill%
      {\usebeamerfont{frame number}\usebeamercolor[fg]{frame number}\insertframenumber~\frameofframes~\inserttotalframenumber}
    \end{beamercolorbox}%
    \begin{beamercolorbox}[colsep=1.5pt]{lower separation line foot}
    \end{beamercolorbox}%
  }
\makeatother

% Table of contents slides on section/subsection
\AtBeginSection[]{
  \begin{frame}
    \tableofcontents[sectionstyle=show/shaded,subsectionstyle=show/shaded/hide,subsubsectionstyle=show/shaded/hide]
  \end{frame}
}
\AtBeginSubsection[]{
  \begin{frame}
    \tableofcontents[sectionstyle=show/shaded,subsectionstyle=show/shaded/hide,subsubsectionstyle=show/shaded/hide]
  \end{frame}
}

\mode<all>
